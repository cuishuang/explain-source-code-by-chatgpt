# File: /Users/fliter/go2023/sys/windows/security_windows.go

在Go语言的sys项目中，/Users/fliter/go2023/sys/windows/security_windows.go文件是用于处理Windows安全相关功能的文件。

SECURITY_NULL_SID_AUTHORITY、SECURITY_WORLD_SID_AUTHORITY、SECURITY_LOCAL_SID_AUTHORITY、SECURITY_CREATOR_SID_AUTHORITY、SECURITY_NON_UNIQUE_AUTHORITY、SECURITY_NT_AUTHORITY、SECURITY_MANDATORY_LABEL_AUTHORITY这几个变量是Windows安全身份验证所使用的身份验证权威。

UserInfo10结构体是用于存储关于用户帐户的信息，比如用户名和全名等。

SidIdentifierAuthority结构体表示安全标识符（SID）的权威。

SID结构体是安全标识符（SID）的数据结构，用于表示在Windows系统上唯一标识用户、组或其他安全主体。

WELL_KNOWN_SID_TYPE是一个枚举类型，表示已知的常用安全标识符类型。

LUID结构体表示唯一标识符，用于唯一标识某个进程或线程的权限。

LUIDAndAttributes结构体表示LUID及其相应的属性。

SIDAndAttributes结构体表示SID及其相应的属性。

Tokenuser结构体是用于表示访问令牌的用户信息。

Tokenprimarygroup结构体是用于表示访问令牌的主组信息。

Tokengroups结构体是用于表示访问令牌的组信息。

Tokenprivileges结构体是用于表示访问令牌的特权信息。

Tokenmandatorylabel结构体是用于表示访问令牌的强制标签信息。

Token结构体是用于表示访问令牌的整体信息。

WTSSESSION_NOTIFICATION结构体是用于表示Windows会话通知的信息。

WTS_SESSION_INFO结构体是用于表示Windows会话信息。

ACL结构体是用于表示访问控制列表。

SECURITY_DESCRIPTOR结构体是用于表示安全描述符。

SECURITY_QUALITY_OF_SERVICE结构体是用于表示安全服务的质量。

SecurityAttributes结构体是用于表示安全属性。

SE_OBJECT_TYPE是一个枚举类型，表示安全对象的类型。

SECURITY_INFORMATION是一个枚举类型，表示安全对象的信息类型。

SECURITY_DESCRIPTOR_CONTROL是一个枚举类型，表示安全描述符的控制位。

ACCESS_MASK是一个类型，表示访问掩码。

ACCESS_MODE是一个类型，表示访问模式。

MULTIPLE_TRUSTEE_OPERATION是一个枚举类型，表示多个委托操作。

TRUSTEE_FORM是一个枚举类型，表示委托的形式。

TRUSTEE_TYPE是一个枚举类型，表示委托的类型。

EXPLICIT_ACCESS结构体表示访问控制列表（ACL）中的显式访问控制项（ACE）的信息。

TrusteeValue结构体是用于表示委托值的信息。

TRUSTEE结构体是用于表示委托的信息。

OBJECTS_AND_SID结构体是用于表示安全对象类型和SID的信息。

OBJECTS_AND_NAME结构体是用于表示安全对象类型和名称的信息。

TranslateAccountName函数用于将帐户名转换为对应的SID。

StringToSid函数将字符串形式的SID转换为对应的SID。

LookupSID函数通过SID查找对应的帐户名称。

String函数将SID转换为字符串形式。

Len函数返回SID的长度。

Copy函数将一个SID复制到另一个SID。

IdentifierAuthority函数返回SID的权威。

SubAuthorityCount函数返回SID的子权限数量。

SubAuthority函数返回SID的指定子权限。

IsValid函数检查SID是否有效。

Equals函数比较两个SID是否相等。

IsWellKnown函数检查SID是否是已知的常用SID。

LookupAccount函数通过SID查找对应的帐户名称。

CreateWellKnownSid函数创建某个已知的常用SID。

CreateWellKnownDomainSid函数创建某个已知的常用域SID。

AllGroups函数返回访问令牌中的所有组。

AllPrivileges函数返回访问令牌中的所有特权。

Size函数返回访问令牌的大小。

OpenCurrentProcessToken函数打开当前进程的访问令牌。

GetCurrentProcessToken函数获取当前进程的访问令牌。

GetCurrentThreadToken函数获取当前线程的访问令牌。

GetCurrentThreadEffectiveToken函数获取当前线程的有效访问令牌。

Close函数关闭访问令牌。

getInfo函数获取访问令牌的信息。

GetTokenUser函数获取访问令牌的用户信息。

GetTokenGroups函数获取访问令牌的组信息。

GetTokenPrimaryGroup函数获取访问令牌的主组信息。

GetUserProfileDirectory函数获取用户的配置文件目录。

IsElevated函数检查当前进程是否提升权限。

GetLinkedToken函数获取链接的访问令牌。

GetSystemDirectory函数获取系统目录。

GetWindowsDirectory函数获取Windows目录。

GetSystemWindowsDirectory函数获取Windows系统目录。

IsMember函数检查用户是否属于指定的组。

IsRestricted函数检查用户是否受限制。

TrusteeValueFromString函数从字符串中解析委托值。

TrusteeValueFromSID函数从SID中创建委托值。

TrusteeValueFromObjectsAndSid函数从对象和SID中创建委托值。

TrusteeValueFromObjectsAndName函数从对象和名称中创建委托值。

Control函数返回安全描述符的控制位。

SetControl函数设置安全描述符的控制位。

RMControl函数返回资源管理器控制标志。

SetRMControl函数设置资源管理器控制标志。

DACL函数返回安全描述符的禁止访问控制列表。

SetDACL函数设置安全描述符的禁止访问控制列表。

SACL函数返回安全描述符的系统访问控制列表。

SetSACL函数设置安全描述符的系统访问控制列表。

Owner函数返回安全描述符的所有者。

SetOwner函数设置安全描述符的所有者。

Group函数返回安全描述符的组。

SetGroup函数设置安全描述符的组。

Length函数返回安全描述符的长度。

ToAbsolute函数将相对安全描述符转换为绝对安全描述符。

ToSelfRelative函数将绝对安全描述符转换为相对安全描述符。

copySelfRelativeSecurityDescriptor函数复制自相对安全描述符。

SecurityDescriptorFromString函数从字符串创建安全描述符。

GetSecurityInfo函数获取指定对象的安全信息。

GetNamedSecurityInfo函数获取指定命名对象的安全信息。

BuildSecurityDescriptor函数构建安全描述符。

NewSecurityDescriptor函数创建一个新的安全描述符。

ACLFromEntries函数从ACE条目创建ACL。

以上是该文件中一些重要的结构体和函数的作用介绍。

